<html>
<head>
<title>Project 1</title>
<link rel="stylesheet" type="text/css" href="project1.css"></link>
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.1.1/jquery.min.js"></script>
<!--Put your D3 import statement between these two lines-->
    <script src="https://d3js.org/d3.v4.min.js"></script>
<!--Put your D3 import statement between these two lines-->
</head>

<body>
	<div id="partOne">
        <h1>Part One: </h1>
	</div>

    <div id="partTwo">
        <h1>Part Two &amp; Four: </h1>
        <h3>Dataset chosen - Anscombe I</h3>
        <h3>Part Four Shown With Part Two</h3>
        <div id="scatterplot">
            <p id="scatterLabel"></p>
            <br />
        </div>
	</div>

    <div id="partThree">
        <h1>Part Three </h1>
        <h3>Dataset for Part Three - Anscombe I</h3>
        <div id="linegraph">
        </div>

	</div>

    <div id="partFive">
        <h1>Part Five: </h1>
        <div id="scatterplotSet">
        </div>
	</div>

    <script type="text/javascript">
        // Put your part one code here ***********************

        d3.csv("data/anscombe_I.csv", function(error, data1){
          if (error) throw error;
          checkDataset(data1);
          createScatterPlot(data1);
          createLineGraph(data1);
        });

        d3.csv("data/anscombe_II.csv", function(error, data2){
          if (error) throw error;
          checkDataset(data2);
        });

        d3.csv("data/anscombe_III.csv", function(error, data3){
          if (error) throw error;
          checkDataset(data3);
        });

        d3.csv("data/anscombe_IV.csv", function(error, data4){
          if (error) throw error;
          checkDataset(data4);
        });

        // Leave this to test your data uploading. All data uploading should be above this line
        function checkDataset(dataset) {
            if (dataset.length == 11)
                $("#partOne").append("<p>data loaded correctly</p>");
            else
                $("#partOne").append("<p>data loaded incorrectly. Try using the debugger to help you find the bug!</p>");
        }

        // Put your part two code here ***********************
        // ***************************************************
        function createScatterPlot(dataset){
          var xVal = 'x';
          var yVal = 'y';
          var margin = {top: 20, right: 20, bottom:30, left:50};
          var width = 480 - margin.left - margin.right;
          var height = 350 - margin.top - margin.bottom;

          var x = d3.scaleLinear().range([0,width]);//map(function(d) { return +d; });
          var y = d3.scaleLinear().range([height,0]);     //think about cartesian plane -> y axis goes to low to high bottom to top

          var svg = d3.select("#scatterplot").append("svg")
                      .attr("width", width + margin.left + margin.right)
                      .attr("height", height + margin.top + margin.bottom)
                      .append("g")
                      .attr("transform", "translate("+ margin.left + "," + margin.top + ")");

          //Scaling the range of the data
          /* adding '+'d[xVal] since the xVal values returned will be strings
             but we want numbers, so appending + sign does that conversion
             thanks to : https://github.com/d3/d3/issues/2912 */
          x.domain(d3.extent(dataset, function(d) {return +d[xVal];}));
          //same thing of '+'d[yVal] as for xVal
          y.domain([0, d3.max(dataset, function(d) {return +d[yVal];})]);

          // Add the scatterplot points
          // Edit - Now it also has the part 4 - Interaction
          svg.selectAll("circle")
             .data(dataset)
             .enter()
             .append("circle")
             .attr("r", 5)
             .attr("cx", function(d){return x(d[xVal]);})
             .attr("cy", function(d){return y(d[yVal]);})
             .attr("fill","lightblue")
             .on("mouseover", function(d) {
                d3.select(this).attr("r", 5).style("fill", "orange");
              })
             .on("mouseout", function(d) {
                d3.select(this).attr("r", 5).style("fill", "lightblue");
              })
              .on("click", function(d) {
                d3.select("#scatterLabel")
                  .text("x = " +  d.x + ";  y = " + d.y);
              });

          // Add the X Axis
          svg.append("g")
             .attr("transform", "translate(0, " + height +")")
             .call(d3.axisBottom(x));

          // Add the Y Axis
          svg.append("g")
             .call(d3.axisLeft(y));

          //Add text labels
          var xLabel = svg.append("text")
                          .attr("class", "label")
                          .text(xVal)
                          .attr("x", width - 20)
                          .attr("y", height - 10);

          var yLabel = svg.append("text")
                          .attr("class", "label")
                          .text(yVal)
                          .attr("y", -10)
                          .attr("transform", "rotate(90)")
                          .style("text-anchor", "start");
        }

        // ***************************************************

        // Put your part three & four code here ***********************
        // ************************************************************

        function createLineGraph(dataset){

          var xVal = 'x';
          var yVal = 'y';
          var margin = {top: 20, right: 20, bottom:30, left:50};
          var width = 480 - margin.left - margin.right;
          var height = 350 - margin.top - margin.bottom;

          var x = d3.scaleLinear().range([0,width]);//map(function(d) { return +d; });
          var y = d3.scaleLinear().range([height,0]);     //think about cartesian plane -> y axis goes to low to high bottom to top

          var valueline = d3.line()
                            .x(function(d) {return x(d[xVal]);})
                            .y(function(d) {return y(d[yVal]);});

          var svg = d3.select("#linegraph").append("svg")
                      .attr("width", width + margin.left + margin.right)
                      .attr("height", height + margin.top + margin.bottom)
                      .append("g")
                      .attr("transform", "translate("+ margin.left + "," + margin.top + ")");

          x.domain(d3.extent(dataset, function(d) {return +d[xVal];}));
          y.domain([0, d3.max(dataset, function(d) {return +d[yVal];})]);

          //Thanks to : https://stackoverflow.com/questions/13645446/sort-data-for-d3-js-path
          dataset.sort(function(a,b) {
            return d3.ascending(+a[xVal],+b[xVal]);
          });

          svg.append("path")
             .data([dataset])
             .attr("class","line")
             .attr("d", valueline(dataset))
             .attr("stroke", "black")
             .attr("fill", "none");

          // Add the X Axis
          svg.append("g")
             .attr("transform", "translate(0, " + height +")")
             .call(d3.axisBottom(x));

          // Add the Y Axis
          svg.append("g")
             .call(d3.axisLeft(y));

          //Add text labels
          var xLabel = svg.append("text")
                          .attr("class", "label")
                          .text(xVal)
                          .attr("x", width - 20)
                          .attr("y", height - 10);

          var yLabel = svg.append("text")
                          .attr("class", "label")
                          .text(yVal)
                          .attr("y", -10)
                          .attr("transform", "rotate(90)")
                          .style("text-anchor", "start");

          svg.selectAll("circle")
             .data(dataset)
             .enter()
             .append("circle")
             .attr("r", 5)
             .attr("cx", function(d){return x(d[xVal]);})
             .attr("cy", function(d){return y(d[yVal]);})
             .attr("fill","lightblue")
             .on("mouseover", function(d) {
                d3.select(this).attr("r", 5).style("fill", "orange");
              })
             .on("mouseout", function(d) {
                d3.select(this).attr("r", 5).style("fill", "lightblue");
              });

        }

        // ************************************************************

        // Put your part five code here ***********************

        // ****************************************************

    </script>
</body>


</html>

